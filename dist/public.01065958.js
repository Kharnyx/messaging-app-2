const conversationsMenuContainer=chatMenu.querySelector(".conversations-menu-contianer"),toggleMenuBtn=document.getElementById("toggle-menu"),menuHead=chatMenu.querySelector(".chat-menu .head"),menuWidth=toPx(computedStyle.getPropertyValue("--menu-open-width"));let containers=Array.from(chatMenu.children);chatMenu.classList.add("open");let openPaddingRight=window.getComputedStyle(chatMenu).paddingRight;chatMenu.classList.remove("open");let closePaddingRight=window.getComputedStyle(chatMenu).paddingRight;for(let element of(openPaddingRight=toPx(openPaddingRight),closePaddingRight=toPx(closePaddingRight),containers.slice(1))){const e=element.getBoundingClientRect(),t=element.offsetParent.getBoundingClientRect();e.top,t.top,e.left,t.left;let n=containers[0].getBoundingClientRect().bottom;element.style.width=`${menuWidth-2*openPaddingRight}px`,element.style.height=`${e.height}px`,element.style.top=`${n}px`,element.style.position="absolute"}function parseTimeToMs(e){return e.endsWith("ms")?parseFloat(time):e.endsWith("s")?1e3*parseFloat(e):0}function toggleMenu(){let e=-(settingsMenuContainer.offsetWidth+2*closePaddingRight);conversationsMenuContainer.style.transform="translateX(0)",settingsMenuContainer.style.transform=`translateX(${e}px)`,chatMenu.classList.contains("settings-open")&&(conversationsMenuContainer.style.transform=`translateX(${e}px)`,settingsMenuContainer.style.transform="translateX(0)");let t=chatMenu.offsetWidth-3.25*rootFontSize;for(let e of(window.getComputedStyle(chatMenu).transitionDuration.split(",").map(e=>e=e.trim()),containers.slice(1)))chatMenu.classList.contains("open")?e.style.width=`${menuWidth-2*openPaddingRight}px`:e.style.width=`${menuWidth-openPaddingRight-closePaddingRight}px`;if(chatMenu.classList.contains("open")||chatMenu.classList.contains("hover")){let e=menuWidth-window.innerWidth;e>0&&(e=0),toggleMenuBtn.querySelector(".tooltip p").textContent="Close Menu",chatMenu.style.transform=`translateX(${e}px)`,chatMenu.style.paddingLeft=`${Math.abs(e)+.5*rootFontSize}px`}else chatMenu.style.transform=`translateX(${-t}px)`,toggleMenuBtn.querySelector(".tooltip p").textContent="Open Menu"}toggleMenuBtn.addEventListener("click",()=>{chatMenu.classList.toggle("open"),chatMenu.classList.contains("conversations-open")||chatMenu.classList.contains("settings-open")||chatMenu.classList.add("conversations-open"),toggleMenu()});const hoverOpen=!1;document.addEventListener("mousemove",e=>{}),toggleMenu();const tagInput=chatMenu.querySelector(".tag-input"),input=tagInput.querySelector("input"),tagsContainer=tagInput.querySelector(".tags"),addUserBtn=tagInput.querySelector("#add-user-button");let tags=[];function createTag(e){let t=document.createElement("div");t.className="tag";let n=document.createElement("span");n.classList.add("tag-label"),n.textContent=e;let s=document.createElement("span");s.className="remove-tag";let o=document.createElement("i");return o.className="fa-solid fa-xmark",s.appendChild(o),s.addEventListener("click",()=>{tags=tags.filter(t=>t!==e),updateTags()}),t.appendChild(n),t.appendChild(s),t}function clearTags(){for(;tagsContainer.firstChild;)tagsContainer.firstChild.remove()}function updateTags(){for(let e of(clearTags(),tags)){let t=createTag(e);tagsContainer.appendChild(t)}tagsContainer.scrollTop=tagsContainer.scrollHeight-tagsContainer.offsetHeight}const keysPressed={};document.addEventListener("keydown",e=>{let t=e.key.toLowerCase();if(keysPressed[t]=!0,document.activeElement===input&&("enter"===t||","===t?(e.preventDefault(),addUserBtn.click()):"backspace"===t&&""===input.value&&(keysPressed.control?tags=[]:tags.pop(),updateTags())),document.activeElement===messageInput){if("enter"===t)if(e.preventDefault(),e.ctrlKey){let e=messageInput.selectionStart,t=messageInput.selectionEnd,n=messageInput.value;messageInput.value=n.slice(0,e)+"\n"+n.slice(t),messageInput.selectionStart=messageInput.selectionEnd=e+1,updateTextareaSize(messageInput)}else sendMessageBtn.click();!keysPressed.control&&keysPressed.enter||keysPressed.control&&keysPressed.enter}}),document.addEventListener("keyup",e=>{keysPressed[e.key.toLowerCase()]=!1}),addUserBtn.addEventListener("click",()=>{let e=input.value.trim().replace(/,/g,"");""===e||tags.includes(e)||(tags.push(e),updateTags()),input.value="",input.focus()});const conversationsContainer=chatMenu.querySelector("#conversations"),createConversationBtn=tagInput.querySelector("#create-conversation-button"),searchConversationsInput=chatMenu.querySelector("#search-conversations");let currentConversations=[];function createConversationDropdown(e){let t=document.createElement("div");t.classList.add("dropdown-content"),t.dataset.toggle=e;let n=document.createElement("a");n.classlist="dropdown-option";let s=document.createElement("i");s.className="fa-regular fa-clipboard";let o=document.createElement("p");return o.textContent="Options",n.append(s,o),t.appendChild(n),t}function createConversation(e,t){let n=e.name;if(!e.users.includes("global-chat")){let t=e.users.filter(e=>e!=userId);if(!e.name)if(t.length<2)n=t[0];else if(2==t.length){let e=t.sort();n=`${e[0]} and ${e[1]}`}else n=`${t.sort()[0]} and ${t.length-1} others`}let s=document.createElement("div");s.className="conversation",e.users.includes("global-chat")?(s.setAttribute("data-users","global-chat"),s.classList.add("global-chat")):s.setAttribute("data-users",e.users.join(","));let o=document.createElement("span");o.textContent=n,o.className="conversation-name";let a=document.createElement("button");a.className="conversation-options-button",a.id=t;let r=createConversationDropdown(t),i=document.createElement("i");return i.className="fa-solid fa-ellipsis",a.appendChild(i),s.appendChild(o),s.appendChild(a),{conversation:s,dropdown:r}}function clearConversations(){for(;conversationsContainer.firstChild;)conversationsContainer.firstChild.remove()}function updateConversations(){clearConversations();for(let e=0;e<currentConversations.length;e++){let t=`conversation-option${e}`,n=createConversation(currentConversations[e],t);n.conversation.addEventListener("click",()=>{setSelectedConversation(n.conversation)}),conversationsContainer.appendChild(n.conversation),n.dropdown&&document.body.appendChild(n.dropdown)}updateDropdowns()}function setSelectedConversation(e){if(!arraysAreEqual(conversationRecipientIds,e.dataset.users.split(","))){for(let t of(conversationRecipientIds=e.dataset.users.split(","),conversationsContainer.children))t.classList.remove("selected");e.classList.add("selected"),loadMessages(messages)}}function addConversation(e){let t=e.filter(e=>""!==e.trim());t.push(userId),t=t.sort();let n=!1;for(let e=0;e<currentConversations.length;e++)if(arraysAreEqual([...currentConversations[e].users].sort(),[...t].sort())){n=!0;break}n?console.log("Conversation Already Exists"):(1===t.length&&t[0]===userId&&console.log("Cannot create a conversation with yourself"),sendToServer("create_conversation",{authToken:authToken,users:t}))}createConversationBtn.addEventListener("click",()=>{if(tags.length>0){if(1===tags.length&&tags[0]===userId)return void console.log("Cannot create a conversation with yourself");addConversation(tags)}else console.log("Add users before creating a conversation")}),updateConversations(),searchConversationsInput.addEventListener("input",()=>{let e=searchConversationsInput.value.toLowerCase().trim(),t=conversationsContainer.querySelectorAll(".conversation");for(let e of t)e.style.display="flex";if(""!==e)for(let n of t)console.log(n.textContent.toLowerCase()),e.tolowerCase().includes(n.textContent.toLowerCase())?n.style.display="flex":n.style.display="none"}),window.addEventListener("resize",()=>{toggleMenu()});
//# sourceMappingURL=public.01065958.js.map
